# PNU (í•„ì§€ê³ ìœ ë²ˆí˜¸) ê°€ì´ë“œ

> ì§€ë²ˆ, ë„ë¡œëª…ì£¼ì†Œ, ì¢Œí‘œë¥¼ PNUë¡œ ë³€í™˜í•˜ëŠ” ê·œì¹™ê³¼ ë°©ë²•

## ğŸ“ PNU êµ¬ì¡°

### ê¸°ë³¸ êµ¬ì„± (19ìë¦¬)

```
[ì‹œë„][ì‹œêµ°êµ¬][ìë©´ë™][  ë¦¬  ][ë³¸ë²ˆ][ë¶€ë²ˆ][ëŒ€ì‚°]
  2     3      3      2     4    4    1
```

**ì˜ˆì‹œ**: `2814010100001000001`
- `28`: ì¸ì²œê´‘ì—­ì‹œ
- `140`: ë‚¨ë™êµ¬
- `101`: ë…¼í˜„ë™
- `00`: ë¦¬ (ë™ ì§€ì—­ì€ 00)
- `0001`: ë³¸ë²ˆ 1ë²ˆ
- `0000`: ë¶€ë²ˆ ì—†ìŒ (0000)
- `1`: ëŒ€ì§€

---

## ğŸ”¢ ê° í•„ë“œ ê·œì¹™

### 1. ì‹œë„ ì½”ë“œ (2ìë¦¬)

| ì½”ë“œ | ì§€ì—­ |
|------|------|
| 11 | ì„œìš¸íŠ¹ë³„ì‹œ |
| 26 | ë¶€ì‚°ê´‘ì—­ì‹œ |
| 27 | ëŒ€êµ¬ê´‘ì—­ì‹œ |
| 28 | **ì¸ì²œê´‘ì—­ì‹œ** |
| 29 | ê´‘ì£¼ê´‘ì—­ì‹œ |
| 30 | ëŒ€ì „ê´‘ì—­ì‹œ |
| 31 | ìš¸ì‚°ê´‘ì—­ì‹œ |
| 36 | ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ |
| 41 | ê²½ê¸°ë„ |
| 42 | ê°•ì›ë„ |
| 43 | ì¶©ì²­ë¶ë„ |
| 44 | ì¶©ì²­ë‚¨ë„ |
| 45 | ì „ë¼ë¶ë„ |
| 46 | ì „ë¼ë‚¨ë„ |
| 47 | ê²½ìƒë¶ë„ |
| 48 | ê²½ìƒë‚¨ë„ |
| 50 | ì œì£¼íŠ¹ë³„ìì¹˜ë„ |

---

### 2. ì‹œêµ°êµ¬ ì½”ë“œ (3ìë¦¬)

**ì¸ì²œê´‘ì—­ì‹œ ì˜ˆì‹œ**:
- `110`: ì¤‘êµ¬
- `140`: ë‚¨ë™êµ¬
- `150`: ì—°ìˆ˜êµ¬
- `170`: ì„œêµ¬
- `185`: ê³„ì–‘êµ¬
- `200`: ê°•í™”êµ°
- `210`: ì˜¹ì§„êµ°
- `237`: ë¯¸ì¶”í™€êµ¬
- `245`: ë¶€í‰êµ¬
- `260`: ë™êµ¬

---

### 3. ìë©´ë™ ì½”ë“œ (3ìë¦¬)

**ë‚¨ë™êµ¬ ì˜ˆì‹œ**:
- `101`: ë…¼í˜„ë™
- `102`: ê°„ì„1ë™
- `103`: ê°„ì„2ë™
- `104`: ê°„ì„3ë™
- `105`: ê°„ì„4ë™
- `106`: êµ¬ì›”1ë™
- `107`: êµ¬ì›”2ë™
- `108`: ë§Œìˆ˜1ë™
- `109`: ë§Œìˆ˜2ë™
- `110`: ë§Œìˆ˜3ë™

---

### 4. ë¦¬ ì½”ë“œ (2ìë¦¬)

- **ë™ ì§€ì—­**: `00` (í•­ìƒ)
- **ì/ë©´ ì§€ì—­**: ë¦¬ ì½”ë“œ (01~99)

**ì˜ˆì‹œ**:
- ë…¼í˜„ë™ â†’ `00`
- ê°•í™”êµ° ê°•í™”ì êµ­í™”ë¦¬ â†’ `01` (ë¦¬ ìˆœì„œì— ë”°ë¼)

---

### 5. ë³¸ë²ˆ (4ìë¦¬)

- ì§€ë²ˆì˜ ë³¸ë²ˆì„ 4ìë¦¬ë¡œ ì œë¡œ íŒ¨ë”©
- ë²”ìœ„: `0001` ~ `9999`

**ì˜ˆì‹œ**:
- 1ë²ˆì§€ â†’ `0001`
- 123ë²ˆì§€ â†’ `0123`
- 1234ë²ˆì§€ â†’ `1234`

---

### 6. ë¶€ë²ˆ (4ìë¦¬)

- ì§€ë²ˆì˜ ë¶€ë²ˆì„ 4ìë¦¬ë¡œ ì œë¡œ íŒ¨ë”©
- ë¶€ë²ˆì´ ì—†ìœ¼ë©´ `0000`
- ë²”ìœ„: `0000` ~ `9999`

**ì˜ˆì‹œ**:
- 1ë²ˆì§€ â†’ `0000` (ë¶€ë²ˆ ì—†ìŒ)
- 1-2ë²ˆì§€ â†’ `0002`
- 1-123ë²ˆì§€ â†’ `0123`
- 1-1234ë²ˆì§€ â†’ `1234`

---

### 7. ëŒ€/ì‚° êµ¬ë¶„ (1ìë¦¬)

| ì½”ë“œ | ì˜ë¯¸ | ì„¤ëª… |
|------|------|------|
| **1** | ëŒ€ì§€ | ì¼ë°˜ í•„ì§€ (íƒì§€, ê³µì¥ìš©ì§€, ëŒ€ì§€ ë“±) |
| **2** | ì‚° | ì„ì•¼ (ì‚°ë¦¼, ëª©ì¥ìš©ì§€ ë“±) |
| **0** | ë¸”ë¡ | ì§‘í•©ê±´ë¬¼ (ì•„íŒŒíŠ¸, ì˜¤í”¼ìŠ¤í…” ë“±) |

**ì¤‘ìš”**:
- ëŒ€ë¶€ë¶„ì˜ ì‚°ì—…ë‹¨ì§€/ê³µì¥ í•„ì§€ëŠ” **ëŒ€ì§€(1)**
- ì‚°ë¦¼ì§€ì—­ì€ **ì‚°(2)**
- ì•„íŒŒíŠ¸/ì˜¤í”¼ìŠ¤í…” ê°™ì€ ì§‘í•©ê±´ë¬¼ì€ **ë¸”ë¡(0)** + ì¸µ/í˜¸ìˆ˜ ì¶”ê°€ ì •ë³´ í•„ìš”

---

## ğŸ”„ ë³€í™˜ ì˜ˆì‹œ

### 1ï¸âƒ£ ì§€ë²ˆ â†’ PNU

**ì…ë ¥**: ì¸ì²œê´‘ì—­ì‹œ ë‚¨ë™êµ¬ ë…¼í˜„ë™ 1-2ë²ˆì§€ (ëŒ€ì§€)

**ë‹¨ê³„**:
1. ì‹œë„: ì¸ì²œ â†’ `28`
2. ì‹œêµ°êµ¬: ë‚¨ë™êµ¬ â†’ `140`
3. ìë©´ë™: ë…¼í˜„ë™ â†’ `101`
4. ë¦¬: ë™ ì§€ì—­ â†’ `00`
5. ë³¸ë²ˆ: 1ë²ˆì§€ â†’ `0001`
6. ë¶€ë²ˆ: 2ë²ˆì§€ â†’ `0002`
7. ëŒ€/ì‚°: ëŒ€ì§€ â†’ `1`

**ê²°ê³¼**: `2814010100001000021`

---

**ì…ë ¥**: ì¸ì²œê´‘ì—­ì‹œ ê°•í™”êµ° ê°•í™”ì êµ­í™”ë¦¬ ì‚° 123ë²ˆì§€

**ë‹¨ê³„**:
1. ì‹œë„: ì¸ì²œ â†’ `28`
2. ì‹œêµ°êµ¬: ê°•í™”êµ° â†’ `200`
3. ìë©´ë™: ê°•í™”ì â†’ `250` (ì˜ˆì‹œ)
4. ë¦¬: êµ­í™”ë¦¬ â†’ `01` (ì˜ˆì‹œ)
5. ë³¸ë²ˆ: 123ë²ˆì§€ â†’ `0123`
6. ë¶€ë²ˆ: ì—†ìŒ â†’ `0000`
7. ëŒ€/ì‚°: ì‚° â†’ `2`

**ê²°ê³¼**: `2820025001012300002`

---

### 2ï¸âƒ£ ë„ë¡œëª…ì£¼ì†Œ â†’ PNU

ë„ë¡œëª…ì£¼ì†ŒëŠ” **ì§ì ‘ ë³€í™˜ ë¶ˆê°€** â†’ ì§€ì˜¤ì½”ë”© API í•„ìš”

**í”„ë¡œì„¸ìŠ¤**:
```
ë„ë¡œëª…ì£¼ì†Œ
    â†“ (ì§€ì˜¤ì½”ë”© API)
ì¢Œí‘œ (ìœ„ë„/ê²½ë„)
    â†“ (ì—­ì§€ì˜¤ì½”ë”© API)
ë²•ì •ë™ ì½”ë“œ + ì§€ë²ˆ
    â†“
PNU
```

**ë„¤ì´ë²„ ì§€ì˜¤ì½”ë”© API ì‚¬ìš©**:
```typescript
// 1. ë„ë¡œëª…ì£¼ì†Œ â†’ ì¢Œí‘œ
const geocodeResponse = await fetch(
    `https://naveropenapi.apigw.ntruss.com/map-geocode/v2/geocode?query=${encodeURIComponent(roadAddress)}`,
    {
        headers: {
            'X-NCP-APIGW-API-KEY-ID': process.env.NAVER_CLIENT_ID,
            'X-NCP-APIGW-API-KEY': process.env.NAVER_CLIENT_SECRET,
        }
    }
);

// 2. ì¢Œí‘œ â†’ ë²•ì •ë™ + ì§€ë²ˆ
const reverseResponse = await fetch(
    `https://naveropenapi.apigw.ntruss.com/map-reversegeocode/v2/gc?coords=${lng},${lat}&orders=addr&output=json`,
    {
        headers: {
            'X-NCP-APIGW-API-KEY-ID': process.env.NAVER_CLIENT_ID,
            'X-NCP-APIGW-API-KEY': process.env.NAVER_CLIENT_SECRET,
        }
    }
);

// 3. ë²•ì •ë™ ì½”ë“œ + ì§€ë²ˆ â†’ PNU
const pnu = buildPNU({
    sido: '28',
    sigungu: '140',
    emd: '101',
    ri: '00',
    bonbun: '0001',
    bubun: '0002',
    type: '1'  // ëŒ€ì§€
});
```

---

### 3ï¸âƒ£ ì¢Œí‘œ â†’ PNU

ì¢Œí‘œë§Œìœ¼ë¡œëŠ” **ì§ì ‘ ë³€í™˜ ë¶ˆê°€** â†’ ì—­ì§€ì˜¤ì½”ë”© API í•„ìš”

**ë„¤ì´ë²„ ì—­ì§€ì˜¤ì½”ë”© API**:
```typescript
async function coordToPNU(lng: number, lat: number): Promise<string | null> {
    const response = await fetch(
        `https://naveropenapi.apigw.ntruss.com/map-reversegeocode/v2/gc?coords=${lng},${lat}&orders=legalcode,addr&output=json`,
        {
            headers: {
                'X-NCP-APIGW-API-KEY-ID': process.env.NAVER_CLIENT_ID,
                'X-NCP-APIGW-API-KEY': process.env.NAVER_CLIENT_SECRET,
            }
        }
    );

    const data = await response.json();

    if (data.status.code !== 0) return null;

    const result = data.results[0];
    const region = result.region;
    const land = result.land;

    // PNU ì¡°í•©
    const pnu = [
        region.area1.code.substring(0, 2),  // ì‹œë„
        region.area2.code.substring(2, 5),  // ì‹œêµ°êµ¬
        region.area3.code.substring(5, 8),  // ìë©´ë™
        '00',  // ë¦¬ (APIì—ì„œ ì œê³µ ì•ˆ í•˜ë©´ 00)
        land.number1.padStart(4, '0'),      // ë³¸ë²ˆ
        land.number2.padStart(4, '0'),      // ë¶€ë²ˆ
        land.type === '1' ? '1' : '2'       // ëŒ€/ì‚° (1=ëŒ€ì§€, 2=ì‚°)
    ].join('');

    return pnu;
}
```

---

## ğŸ› ï¸ PNU ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜

### buildPNU - PNU ìƒì„±

```typescript
// lib/utils/pnuHelpers.ts

interface PNUComponents {
    sido: string;        // 2ìë¦¬
    sigungu: string;     // 3ìë¦¬
    emd: string;         // 3ìë¦¬
    ri: string;          // 2ìë¦¬ (ë™=00, ìë©´=ë¦¬ì½”ë“œ)
    bonbun: number;      // ë³¸ë²ˆ
    bubun: number;       // ë¶€ë²ˆ (ì—†ìœ¼ë©´ 0)
    type: '1' | '2' | '0';  // 1=ëŒ€ì§€, 2=ì‚°, 0=ë¸”ë¡
}

export function buildPNU(components: PNUComponents): string {
    const {
        sido,
        sigungu,
        emd,
        ri,
        bonbun,
        bubun,
        type
    } = components;

    return [
        sido.padStart(2, '0'),
        sigungu.padStart(3, '0'),
        emd.padStart(3, '0'),
        ri.padStart(2, '0'),
        bonbun.toString().padStart(4, '0'),
        bubun.toString().padStart(4, '0'),
        type
    ].join('');
}
```

---

### parsePNU - PNU íŒŒì‹±

```typescript
export interface ParsedPNU {
    sido: string;
    sigungu: string;
    emd: string;
    ri: string;
    bonbun: number;
    bubun: number;
    type: '1' | '2' | '0';
    jibun: string;  // "1-2" í˜•ì‹
}

export function parsePNU(pnu: string): ParsedPNU | null {
    if (pnu.length !== 19) {
        console.error('PNUëŠ” 19ìë¦¬ì—¬ì•¼ í•©ë‹ˆë‹¤');
        return null;
    }

    const sido = pnu.substring(0, 2);
    const sigungu = pnu.substring(2, 5);
    const emd = pnu.substring(5, 8);
    const ri = pnu.substring(8, 10);
    const bonbun = parseInt(pnu.substring(10, 14), 10);
    const bubun = parseInt(pnu.substring(14, 18), 10);
    const type = pnu.substring(18, 19) as '1' | '2' | '0';

    // ì§€ë²ˆ í˜•ì‹
    let jibun = bonbun.toString();
    if (bubun > 0) {
        jibun += `-${bubun}`;
    }

    // ì‚°/ëŒ€ í‘œì‹œ
    if (type === '2') {
        jibun = `ì‚° ${jibun}`;
    }

    return {
        sido,
        sigungu,
        emd,
        ri,
        bonbun,
        bubun,
        type,
        jibun
    };
}
```

---

### jibunToPNU - ì§€ë²ˆ â†’ PNU

```typescript
export interface JibunInput {
    sido: string;        // ì‹œë„ ì½”ë“œ (2ìë¦¬)
    sigungu: string;     // ì‹œêµ°êµ¬ ì½”ë“œ (3ìë¦¬)
    emd: string;         // ìë©´ë™ ì½”ë“œ (3ìë¦¬)
    ri?: string;         // ë¦¬ ì½”ë“œ (2ìë¦¬, ì„ íƒ)
    jibun: string;       // "1-2" ë˜ëŠ” "ì‚° 123"
}

export function jibunToPNU(input: JibunInput): string {
    const { sido, sigungu, emd, ri = '00', jibun } = input;

    // ì‚°/ëŒ€ êµ¬ë¶„
    let type: '1' | '2' = '1';
    let cleanJibun = jibun;

    if (jibun.startsWith('ì‚° ')) {
        type = '2';
        cleanJibun = jibun.substring(2).trim();
    }

    // ë³¸ë²ˆ/ë¶€ë²ˆ ë¶„ë¦¬
    const parts = cleanJibun.split('-');
    const bonbun = parseInt(parts[0], 10);
    const bubun = parts[1] ? parseInt(parts[1], 10) : 0;

    return buildPNU({
        sido,
        sigungu,
        emd,
        ri,
        bonbun,
        bubun,
        type
    });
}
```

---

## ğŸŒ API ì—°ë™ ì˜ˆì‹œ

### ë„ë¡œëª…ì£¼ì†Œ â†’ PNU ì „ì²´ í”„ë¡œì„¸ìŠ¤

```typescript
// lib/utils/addressToPNU.ts

export async function roadAddressToPNU(roadAddress: string): Promise<string | null> {
    try {
        // 1. ì§€ì˜¤ì½”ë”©: ë„ë¡œëª…ì£¼ì†Œ â†’ ì¢Œí‘œ
        const geocodeRes = await fetch(
            `https://naveropenapi.apigw.ntruss.com/map-geocode/v2/geocode?query=${encodeURIComponent(roadAddress)}`,
            {
                headers: {
                    'X-NCP-APIGW-API-KEY-ID': process.env.NAVER_CLIENT_ID!,
                    'X-NCP-APIGW-API-KEY': process.env.NAVER_CLIENT_SECRET!,
                }
            }
        );

        const geocodeData = await geocodeRes.json();

        if (geocodeData.status !== 'OK' || geocodeData.addresses.length === 0) {
            return null;
        }

        const { x: lng, y: lat } = geocodeData.addresses[0];

        // 2. ì—­ì§€ì˜¤ì½”ë”©: ì¢Œí‘œ â†’ ë²•ì •ë™ + ì§€ë²ˆ
        const reverseRes = await fetch(
            `https://naveropenapi.apigw.ntruss.com/map-reversegeocode/v2/gc?coords=${lng},${lat}&orders=legalcode,addr&output=json`,
            {
                headers: {
                    'X-NCP-APIGW-API-KEY-ID': process.env.NAVER_CLIENT_ID!,
                    'X-NCP-APIGW-API-KEY': process.env.NAVER_CLIENT_SECRET!,
                }
            }
        );

        const reverseData = await reverseRes.json();

        if (reverseData.status.code !== 0) return null;

        const result = reverseData.results[0];
        const region = result.region;
        const land = result.land;

        // 3. PNU ì¡°í•©
        const pnu = buildPNU({
            sido: region.area1.code.substring(0, 2),
            sigungu: region.area2.code.substring(2, 5),
            emd: region.area3.code.substring(5, 8),
            ri: '00',  // APIì—ì„œ ì œê³µ ì•ˆ í•˜ë©´ 00
            bonbun: parseInt(land.number1, 10),
            bubun: land.number2 ? parseInt(land.number2, 10) : 0,
            type: land.type === '1' ? '1' : '2'
        });

        return pnu;
    } catch (error) {
        console.error('ë„ë¡œëª…ì£¼ì†Œ â†’ PNU ë³€í™˜ ì‹¤íŒ¨:', error);
        return null;
    }
}
```

---

## ğŸ“ ì£¼ì˜ì‚¬í•­

### 1. ëŒ€/ì‚° êµ¬ë¶„ì˜ ì¤‘ìš”ì„±

- **ëŒ€ì§€(1)**: ê±´ë¬¼ì´ ìˆëŠ” ë•…, ê³µì¥ìš©ì§€, íƒì§€ ë“±
- **ì‚°(2)**: ì„ì•¼, ì‚°ë¦¼ì§€, ëª©ì¥ìš©ì§€ ë“±
- **ì˜ëª»ëœ êµ¬ë¶„ ì‹œ ê²€ìƒ‰ ì‹¤íŒ¨**

**ì˜ˆì‹œ**:
```
âœ… ì˜¬ë°”ë¦„: ë…¼í˜„ë™ 1-2 (ëŒ€ì§€) â†’ ...0001000021
âŒ í‹€ë¦¼:   ë…¼í˜„ë™ 1-2 (ì‚°)   â†’ ...0001000022  (ê²€ìƒ‰ ì•ˆ ë¨)
```

---

### 2. ë¸”ë¡(0)ì˜ íŠ¹ìˆ˜ì„±

ì§‘í•©ê±´ë¬¼ (ì•„íŒŒíŠ¸, ì˜¤í”¼ìŠ¤í…” ë“±)ì€ PNUì— **ì¸µ/í˜¸ìˆ˜ ì •ë³´ê°€ ì¶”ê°€**:

```
PNU (19ìë¦¬) + ì¸µ(2ìë¦¬) + í˜¸ìˆ˜(4ìë¦¬) = 25ìë¦¬
```

**ì˜ˆì‹œ**: ë…¼í˜„ë™ 1-2 ì•„íŒŒíŠ¸ 5ì¸µ 101í˜¸
```
2814010100001000020 + 05 + 0101 = 2814010100001000020050101
```

---

### 3. API ì‘ë‹µ ê²€ì¦

ë„¤ì´ë²„ API ì‘ë‹µì€ ì™„ë²½í•˜ì§€ ì•ŠìŒ:
- ë¦¬(é‡Œ) ì½”ë“œê°€ ì—†ì„ ìˆ˜ ìˆìŒ â†’ `00` ì‚¬ìš©
- ëŒ€/ì‚° êµ¬ë¶„ì´ í‹€ë¦´ ìˆ˜ ìˆìŒ â†’ ìˆ˜ë™ í™•ì¸ í•„ìš”
- ì‹ ê·œ í•„ì§€ëŠ” ëˆ„ë½ë  ìˆ˜ ìˆìŒ

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [êµ­í† êµí†µë¶€ ë¶€ë™ì‚° ê³µì‹œê°€ê²© ì•Œë¦¬ë¯¸](https://www.realtyprice.kr/)
- [ë„¤ì´ë²„ ì§€ë„ API ë¬¸ì„œ](https://api.ncloud-docs.com/docs/ai-naver-mapsgeocoding)
- [ë²•ì •ë™ ì½”ë“œ ì¡°íšŒ](https://www.code.go.kr/)

---

## ğŸ“ ë³€ê²½ ì´ë ¥

| ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|------|-----------|
| 2025-12-23 | ì´ˆê¸° ë¬¸ì„œ ìƒì„±, PNU êµ¬ì¡° ë° ë³€í™˜ ê·œì¹™ ì •ì˜ |
